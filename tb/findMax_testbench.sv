// Module: findMax_testbench.sv
// Author: Rehan Iqbal
// Date: January 30, 2017
// Company: Portland State University
//
// Description:
// ------------
// Instantiates the device-under-test (findMax) and runs through a series of
// byte sequences. These are randomly generated bytes which range in value from
// 0 to 255. The number of bytes sent varies between 1 & 16.
//
//
//The testbench will run for a user-specified number of trials before ending.
// It will write results to a local textfile specifying the data bytes sent out
// and the maxValue & minValue returned by the DUT.
// 
///////////////////////////////////////////////////////////////////////////////

module findMax_testbench;

	timeunit 1ns;

	/*************************************************************************/
	/* Top-level port declarations											 */
	/************************\************************************************/


	logic 			clk_tb;				// clock signal to the DUT
	logic 			reset_tb;			// active-high reset to the DUT
	logic 			start_tb;			// active-high start signal to the DUT
	logic	[7:0]	inputA_tb;			// data byte inputs to the DUT
	logic	[7:0]	maxValue_tb;		// maximum value returned by DUT
	logic 			done_tb;			// active-high completion signal from DUT

	int 			fhandle;			// integer to hold file location

	/*************************************************************************/
	/* Global Assignments													 */
	/*************************************************************************/	


	/*************************************************************************/
	/* Instantiating the DUT 												 */
	/*************************************************************************/

	findMax DUT (

		.clk			(clk_tb),			// I [0:0] clock signal to the circuit
		.reset			(reset_tb), 		// I [0:0] assert high to reset the circuit
		.start			(start_tb), 		// I [0:0] assert high to start data input
		.inputA			(inputA_tb),		// I [7:0] data byts to be considered

		.maxValue		(maxValue_tb),		// O [7:0] current max value of the sequence
		.done			(done_tb)			// O [0:0] goes high when final value determined

		);

	/*************************************************************************/
	/* Running the testbench simluation										 */
	/*************************************************************************/

	// format time units for printing later
	// also setup the output file location

	initial begin
		$timeformat(-9, 0, "ns", 8);
		fhandle = $fopen("C:/Users/riqbal/Desktop/findMax_results.txt");
	end

	// main simulation loop

	initial begin

			// print results to file
			$fstrobe(fhandle, "Time:\t%t\t\tYear: %d\t\tMonth: %d\t\tDay of Month: %d\t\tDay of Year: %d\t", $time, year_tester, month_tester, dayOfMonth_tester, dayOfYear_tester);

		end

		// wrap up file writing & finish simulation
		$fwrite(fhandle, "\n\nEND OF FILE");
		$fclose(fhandle);
		$stop;
	end

endmodule